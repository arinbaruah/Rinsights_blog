{
  "hash": "2a775d8de5adf3923e37a0aebbb5ce26",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Visualisation\"\nauthor: \"Arindam Baruah\"\nformat: html\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggthemes)\nlibrary(ggplot2)\nlibrary(janitor)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'janitor'\n\nThe following objects are masked from 'package:stats':\n\n    chisq.test, fisher.test\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggcirclepack)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_survey <- read_csv(\"data/survey.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 1259 Columns: 27\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (25): Gender, Country, state, self_employed, family_history, treatment,...\ndbl   (1): Age\ndttm  (1): Timestamp\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\ndf_substance_deaths <- read_csv(\"data/death-rate-from-mental-health-and-substance-use-disorders-who.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 4422 Columns: 4\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (2): Entity, Code\ndbl (2): Year, Death rate from mental and substance use disorders among both...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\ndf_substance_deaths_age <- read_csv(\"data/deaths-substance-disorders-age-who.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 4422 Columns: 8\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (2): Entity, Code\ndbl (6): Year, Deaths from substance use disorders among both sexes aged 70+...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\ndf_us_mental_deaths <- read_csv(\"data/US_mental_order_deaths.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 4422 Columns: 4\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (2): Entity, Code\ndbl (2): Year, Total deaths from mental and substance use disorders among bo...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\ndf_drug_dependency <- read_csv(\"data/mental-health-as-risk-for-drug-dependency.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 18 Columns: 4\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): Entity\ndbl (2): Year, Increased risk of illicit drug dependency\nlgl (1): Code\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\ndf_drug_gender <- read_csv(\"data/deaths-drug-use-disorders-by-sex.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 4422 Columns: 5\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (2): Entity, Code\ndbl (3): Year, Total deaths from drug use disorders among females, Total dea...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\ndf_drug_deaths <- tibble(drug = c(\"Tobacco\",\"Alcohol use\",\"Illicit drugs\"),\n                         deaths = c(7.25*10^6,2*10^6,600638)) # Deaths in 2021 by IHME, Global burden of disease\ndf_pop <- read_csv(\"data/population.csv\",skip = 3)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nNew names:\nRows: 266 Columns: 69\n── Column specification\n──────────────────────────────────────────────────────── Delimiter: \",\" chr\n(4): Country Name, Country Code, Indicator Name, Indicator Code dbl (64): 1960,\n1961, 1962, 1963, 1964, 1965, 1966, 1967, 1968, 1969, 1970, ... lgl (1): ...69\nℹ Use `spec()` to retrieve the full column specification for this data. ℹ\nSpecify the column types or set `show_col_types = FALSE` to quiet this message.\n• `` -> `...69`\n```\n\n\n:::\n\n```{.r .cell-code}\ndf_overdose <- read_csv(\"data/drug-overdose-death-rates.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 22 Columns: 8\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (2): Entity, Code\ndbl (6): Year, Any opioid death rates (CDC WONDER), Cocaine overdose death r...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(stringr)\nlibrary(glue)\nlibrary(ggrepel)\nlibrary(ggplot2)\nlibrary(ggtext)\nlibrary(sysfonts)\nlibrary(showtext)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: showtextdb\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(geomtextpath)\nlibrary(stringr)\nlibrary(ggplot2)\nlibrary(ggnewscale)\nlibrary(paletteer)\nlibrary(colorspace)\nlibrary(extrafont)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRegistering fonts with R\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'extrafont'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:showtextdb':\n\n    font_install\n```\n\n\n:::\n\n```{.r .cell-code}\n# caption handles\nswd <- str_glue(\"#SWDchallenge: June 2024 &bull; Source: Synthetic data from ChatGPT<br>\")  \nli <- str_glue(\"<span style='font-family:fa6-brands'>&#xf08c;</span>\")  \ngh <- str_glue(\"<span style='font-family:fa6-brands'>&#xf09b;</span>\")\nmn <- str_glue(\"<span style='font-family:fa6-brands'>&#xf4f6;</span>\")\n\n\n# plot colors\nbkg_col      <- \"#FEF9E7\" #colorspace::lighten(\"#FEF9E7\", 0.05)    \ntitle_col    <- \"#3d3d3d\"           \nsubtitle_col <- \"#3d3d3d\"     \ncaption_col  <- \"#72647D\"   \ntext_col     <- colorspace::darken(\"gray40\" , 0.2)  \n\n# fonts\n\nfont_add('fa6-brands','fontawesome/otfs/Font Awesome 6 Brands-Regular-400.otf') \nfont_add_google(\"DM Serif Display\", regular.wt = 400, family = \"title\")                 \nfont_add_google(\"Urbanist\", regular.wt = 400, family = \"subtitle\")  \nfont_add_google(\"Quattrocento Sans\", regular.wt = 400, family = \"text\")        \nfont_add_google(\"Merriweather\", regular.wt = 400,family = \"caption\")\n\nshowtext_auto(enable = TRUE)  \n\n\nX_icon <- glue(\"<span style='font-family:fa6-brands'>&#xe61b;</span>\")\n\ncaption_text <- str_glue(\"{li} Arindam Baruah | {X_icon} @wizsights | {gh} arinbaruah | Source: TidyTuesday |#rstudio #ggplot2\")\n\ntheme_set(theme_minimal(base_size = 15, base_family = \"text\"))                \n\n# Theme updates\n\ntheme_update(\n  plot.title.position   = \"plot\",\n  plot.caption.position = \"plot\",\n  legend.position       = 'plot',\n  plot.margin           = margin(t = 10, r = 15, b = 0, l = 15),\n  plot.background       = element_rect(fill = bkg_col, color = bkg_col),\n  panel.background      = element_rect(fill = bkg_col, color = bkg_col),\n  axis.title.x          = element_text(margin = margin(10, 0, 0, 0), size = rel(1), color = text_col, family = 'text', face = 'bold'),\n  axis.title.y          = element_text(margin = margin(0, 10, 0, 0), size = rel(1), color = text_col, family = 'text', face = 'bold'),\n  axis.text             = element_text(size = 10, color = text_col, family = 'text',face = \"bold\"),\n  panel.grid.minor.y    = element_blank(),\n  panel.grid.major.y    = element_line(linetype = \"dotted\", linewidth = 0.1, color = 'gray40'),\n  panel.grid.minor.x    = element_blank(),\n  panel.grid.major.x    = element_blank(),\n  axis.line.x           = element_line(color = \"#d7d7d8\", linewidth = .2),\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_drug_gender <- df_drug_gender %>% filter(Year == 2021)\ndf_pop <- df_pop %>% select(`Country Name`,`2021`) \ndf_drug_gender <- inner_join(df_drug_gender,df_pop,by = c(\"Entity\"=\"Country Name\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_drug_gender %>% mutate(prop_male = 100*`Total deaths from drug use disorders among females` / `2021`) %>% \n  filter(`Total deaths from drug use disorders among males` > 1000)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 9 × 7\n  Entity        Code   Year Total deaths from dr…¹ Total deaths from dr…² `2021`\n  <chr>         <chr> <dbl>                  <dbl>                  <dbl>  <dbl>\n1 Brazil        BRA    2021                   352.                  1002. 2.14e8\n2 Canada        CAN    2021                  1781.                  5552. 3.82e7\n3 China         CHN    2021                  2302.                  8943. 1.41e9\n4 Germany       DEU    2021                   359.                  1188. 8.32e7\n5 India         IND    2021                  2898.                  5552. 1.41e9\n6 North America <NA>   2021                 32910.                 82449. 3.70e8\n7 United Kingd… GBR    2021                  1496.                  4135. 6.70e7\n8 United States USA    2021                 30935.                 76046. 3.32e8\n9 World         OWID…  2021                 48449.                126045. 7.89e9\n# ℹ abbreviated names: ¹​`Total deaths from drug use disorders among females`,\n#   ²​`Total deaths from drug use disorders among males`\n# ℹ 1 more variable: prop_male <dbl>\n```\n\n\n:::\n:::\n\n\n# Share of deaths across genders\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncontinents <- c(\"North America\",\"South America\",\"Asia\",\"Oceania\",\"Africa\",\"World\")\n\nimp_countries <- c(\"India\",\"China\",\"United States\",\"Australia\",\"Canada\",\"Germany\",\"United Kingdom\")\n\n\noptions(scipen = 1000)\n\nnote_text <- \"Equal male and female deaths\"\n\ngr1 <- ggplot(data = df_drug_gender %>% filter(!Entity %in% continents),\n              aes(y = `Total deaths from drug use disorders among males`, \nx = `Total deaths from drug use disorders among females`)) + geom_point(color = \"lightgray\") +\n  geom_point(data = df_drug_gender %>% filter(!Entity %in% continents & Entity %in% imp_countries),\n             color = \"steelblue\",size = 4) +\n  geom_point(data = df_drug_gender %>% filter(Entity == \"Ghana\"),\n             color = \"#FA8072\",size = 4) +\n  geom_abline(intercept = 0,slope = 1,linetype = \"dashed\",alpha = 0.3) + \n  geom_text_repel(data = df_drug_gender %>% filter(Entity %in% imp_countries | Entity == \"Ghana\"),\n                  aes(label = Entity,\n                      hjust = -0.5,\n                      vjust = 2),\n                  size = rel(12),\n                  fontface = \"bold\") +\n     geom_richtext(\n     aes(\n      x = 100, y = 10,\n      label = note_text,\n      family = \"text\"\n    ),\n    vjust = 1.1,\n    label.color = NA,\n    size = rel(12),\n    fill = bkg_col\n  ) + \n    geom_curve(\n    aes(x = 96, xend = 75, y = 12, yend = 50),\n    curvature = 0.2,\n    arrow = arrow(length = unit(0.15, \"cm\"), type = \"closed\"),\n    color = \"black\"\n  ) +\n  scale_x_continuous(transform = \"log10\",labels = scales::comma) +\n  scale_y_continuous(transform = \"log10\",labels = scales::comma) +\n  labs(x =     \"Female deaths\",\n       y =     \"Male deaths\",\n       title = \"Drug Use Disorders and Mortality: Understanding the Gender Gap\",\n       subtitle = \"The data across various countries has revealed a concerning trend: the number of deaths resulting from <span style='color: darkred;'>  drug use disorders is significantly high <br> in the United States </span>, with approximately <strong> 100,000 deaths recorded in 2021 alone </strong>. Furthermore, the data suggests that in most countries with <br> the exception of Ghana, males are disproportionately affected by drug use disorders, with <strong> death rates among males consistently exceeding <br> those among females </strong>. This highlights that males are at a far greater risk of succumbing to the harmful effects of illicit drugs.\",\n       caption = \"#Rstudio #ggplot2 | Source: IHME, Global Burden of Disease, 2021\") +\n  theme(legend.position = \"top\",\n    legend.title.position = \"top\",\n    legend.title = element_text(\n      color = text_col,\n      hjust = 0.5,\n      family = \"text\",\n      face = \"bold\",\n      size = rel(1),\n    ),\n    legend.text = element_text(\n      color = text_col,\n      family = \"text\",\n      size = rel(1),\n      face = \"bold\"\n    ),\n    plot.title            = element_text(\n      size                = 70,\n      family              = \"title\",\n      face                = \"bold\",\n      color               = title_col,\n      lineheight          = 0.3,\n      margin              = margin(t = 5, b = 5),\n      hjust               = 0.5\n    ),        \n    plot.subtitle         = element_markdown(\n      size                = 35, \n      family              = 'subtitle',\n      color               = subtitle_col,\n      hjust               = 0,\n      lineheight          = 0.4, \n      margin              = margin(t = 5, b = 1)\n    ),\n      plot.caption          = element_markdown(\n      size                = rel(2), \n      family              = 'caption',\n      color               = caption_col,\n      lineheight          = 0.3,\n      hjust               = 0.5,\n      halign              = 0,\n      margin              = margin(t = 10, b = 10)\n    ),\n    axis.title = element_markdown(\n      size = rel(3),\n      face = \"bold\"\n    ),\n    axis.text  = element_markdown(\n      size = rel(1.5)\n    )\n  ) \n\nggsave(\"images/Gender_death_rate.jpeg\",gr1,dpi = 300,height = 6, width = 10)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_drug_gender %>% filter(Entity != continents) %>% mutate(ratio = `Total deaths from drug use disorders among females`/`Total deaths from drug use disorders among males`) %>% arrange(-ratio)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: There was 1 warning in `filter()`.\nℹ In argument: `Entity != continents`.\nCaused by warning in `Entity != continents`:\n! longer object length is not a multiple of shorter object length\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 168 × 7\n   Entity       Code   Year Total deaths from dr…¹ Total deaths from dr…² `2021`\n   <chr>        <chr> <dbl>                  <dbl>                  <dbl>  <dbl>\n 1 Ghana        GHA    2021                   5.78                   0.01 3.28e7\n 2 Lesotho      LSO    2021                  11.1                    6.69 2.28e6\n 3 Armenia      ARM    2021                   5.97                   3.93 2.79e6\n 4 Botswana     BWA    2021                   5.7                    4.67 2.59e6\n 5 Dominica     DMA    2021                   0.21                   0.18 7.24e4\n 6 Nicaragua    NIC    2021                   1.46                   1.32 6.85e6\n 7 Belize       BLZ    2021                   0.22                   0.2  4.00e5\n 8 Japan        JPN    2021                 140.                   132.   1.26e8\n 9 South Africa ZAF    2021                 614.                   590.   5.94e7\n10 Eswatini     SWZ    2021                   4.14                   4.39 1.19e6\n# ℹ 158 more rows\n# ℹ abbreviated names: ¹​`Total deaths from drug use disorders among females`,\n#   ²​`Total deaths from drug use disorders among males`\n# ℹ 1 more variable: ratio <dbl>\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_col = c(\"United States\" = \"#A93226\",\"Canada\" = \"#E67E22\",\"North America\" = \"#AAB7B8\", \n           \"South America\" = \"#AAB7B8\", \"Asia\" = \"#AAB7B8\",\"Oceania\" = \"#AAB7B8\",\"Africa\" = \"#AAB7B8\")\ntags<- c(\"North America\",\"South America\",\"Asia\",\"Oceania\",\"Africa\",\"United States\",\"Canada\")\n\ngr2 <- ggplot(data = df_substance_deaths %>% filter(Entity %in% tags) , aes(x = Year,\n                                       y = `Death rate from mental and substance use disorders among both sexes`\n                                       )) + \n    geom_rect(\n    xmin = 2020, xmax = 2022, \n    ymin = 0, ymax = 40,\n    fill = \"#F9E79F\",\n    alpha = 0.1\n  ) +\n  geom_line(aes(group = Entity,colour = Entity),linewidth = 0.25) +\n  geom_point(\n        aes(color = Entity), fill = \"grey96\",\n        shape = 21, size = 2, stroke = .25\n    ) +\n  scale_color_manual(values = my_col |> lighten(.5)) +\n    new_scale_color() +\n    geom_smooth(\n        aes(group = Entity, color = Entity),\n        linewidth = 4, se = FALSE, lineend = \"round\"\n    ) +\n\n    scale_color_manual(values = my_col |> alpha(0.3)) +\n    \n    new_scale_color() +\n    geom_textsmooth(\n        aes(color = Entity, label = Entity),\n        linewidth = .5, se = FALSE, lineend = \"round\",\n        fontface = \"bold\",\n        size = rel(10)\n    ) +    # theme_minimal()  +\n  annotate(\n  \"text\",\n  x = 2021,\n  y = 10,\n  colour = \"#BA4A00\",\n  label = 'COVID-19', size = unit(10, \"pt\")\n) + labs(x = \"Year\",\n         y = \"Deaths per 100K people\",\n         title = \"Global Trends in Deaths from <br> Mental Health and Substance Use Disorders (2000-2022)\",\n         subtitle = \"The number of deaths due to mental health and substance use disorders per 100,000 individuals over the years reveals a troubling trend <br> for two specific countries:<span style='color: darkred;'> the United States and Canada </span>. While the death rates have remained relatively stable across other continents, <br> North America presents a stark contrast. Both countries have experienced a significant increase in deaths, particularly in recent years. <strong> <br> This rise has been notably steep following the COVID-19 pandemic </strong>,which may have exacerbated mental health issues due to extended <br> periods of isolation and other pandemic-related stressors. \",\n         caption = \"#Rstudio #ggplot2 | Source: World Health Organisation\") +\n\n    scale_color_manual(values = my_col |> darken(.25)) +\n  theme(legend.position = \"none\",\n    legend.title.position = \"top\",\n    legend.title = element_text(\n      color = text_col,\n      hjust = 0.5,\n      family = \"text\",\n      face = \"bold\",\n      size = rel(2),\n    ),\n    legend.text = element_text(\n      color = text_col,\n      family = \"text\",\n      size = rel(1),\n      face = \"bold\"\n    ),\n    plot.background = element_rect(colour = bkg_col),\n  plot.title            = element_markdown(\n      size                = 70,\n      family              = \"title\",\n      face                = \"bold\",\n      color               = title_col,\n      lineheight          = 0.3,\n      margin              = margin(t = 5, b = 5),\n      hjust               = 0.5\n    ),        \n    plot.subtitle         = element_markdown(\n      size                = 35, \n      family              = 'subtitle',\n      color               = subtitle_col,\n      hjust               = 0,\n      lineheight          = 0.4, \n      margin              = margin(t = 5, b = 1)\n    ),\n      plot.caption          = element_markdown(\n      size                = rel(2), \n      family              = 'caption',\n      color               = caption_col,\n      lineheight          = 0.3,\n      hjust               = 0.5,\n      halign              = 0,\n      margin              = margin(t = 10, b = 10)\n    ),\n    axis.title = element_markdown(\n      size = rel(2),\n      family = \"text\",\n      face = \"bold\"\n    ),\n    axis.text  = element_markdown(\n      size = rel(2.5)\n    )\n  )  + xlim(c(2000,2022)) \n\ngr2\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](matilda_viz_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggsave(\"images/Global_death_rate.jpeg\",gr2,dpi = 300,height = 6, width = 10)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_substance_deaths_age <- df_substance_deaths_age %>% clean_names()\ndf_substance_deaths_age_long <- df_substance_deaths_age %>% pivot_longer(cols = c(4:8),\n                                                                         values_to = \"deaths\",\n                                                                         names_to = \"age_group\")\n\ndim_order <- c(\"0-4\",\"5-14\", \"15-49\", \"50-69\",\">=70\",\"all\")\n\n\ndf_substance_deaths_age_long <- df_substance_deaths_age_long %>%  group_by(year) %>% mutate(age_group_clean = case_match(age_group,           \"deaths_from_substance_use_disorders_among_both_sexes_aged_0_4_year_olds\" ~ \"0-4\", \n                                                                                                                         \"deaths_from_substance_use_disorders_among_both_sexes_aged_5_14_year_olds\" ~ \"5-14\", \n                                                                                                                         \"deaths_from_substance_use_disorders_among_both_sexes_aged_15_49_year_olds\" ~ \"15-49\", \n                                                                                                                         \"deaths_from_substance_use_disorders_among_both_sexes_aged_50_69_year_olds\" ~ \"50-69\",\n                                                                                                                         \"deaths_from_substance_use_disorders_among_both_sexes_aged_70_year_olds\" ~ \">=70\",\n                                                                                  .default = \"all\")) %>%\n   mutate(age_group_clean = factor(age_group_clean, levels = dim_order))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nage_exclude <- c(\"all\",\"0-4\",\"5-14\")\ndf_substance_deaths_age_long <- df_substance_deaths_age_long %>% filter(!age_group_clean %in% age_exclude)\ndf_substance_deaths_age_long_grouped <- df_substance_deaths_age_long %>% group_by(age_group_clean,year) %>% summarise(Total_deaths = sum(deaths))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`summarise()` has grouped output by 'age_group_clean'. You can override using\nthe `.groups` argument.\n```\n\n\n:::\n\n```{.r .cell-code}\ndf_substance_deaths_age_long_grouped$age_group_clean <- paste0(\n    df_substance_deaths_age_long_grouped$age_group_clean,\" yrs\"\n)\n\ndf_substance_deaths_age_long_grouped <- df_substance_deaths_age_long_grouped %>% filter(year >= 2016)\ndf_substance_deaths_age_long_grouped <- df_substance_deaths_age_long_grouped %>% \n                                          mutate(Total_deaths = Total_deaths/10^6) %>% \n                                          mutate(Total_deaths = round(Total_deaths,1)) \n\ndf_substance_deaths_age_long_grouped$Total_deaths_label <- paste0(\n    df_substance_deaths_age_long_grouped$Total_deaths,\" mil\"\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntitle_text <- \"Persistent Trends in Deaths from Mental Health and Substance Use Disorders <br> among Middle-Aged Groups\"\n\nsubtitle_text <- \"A closer examination of deaths due to mental health and substance use disorders reveals that <strong> middle-aged individuals, <br> particularly  those between 15-49 years, have consistently  experienced the highest mortality rates.</strong> In recent years, the <br> death toll in this age group has reached up to <span style='color: darkred;'>half a million annually </span>, closely followed by those aged 50-69 years. A <br> significant portion of these deaths occur among the working-age population, suggesting that <strong> professional pressures <br> and stress could be major contributing factors to the decline in mental health, particularly for individuals aged 15-49. </strong>\"\n\n\ngr3 <- ggplot(df_substance_deaths_age_long_grouped, aes(id = age_group_clean,area = Total_deaths,fill = Total_deaths)) +\n  geom_circlepack() +\n    geom_circlepack_text( aes(y = after_stat(y + 0.1),\n                              label = Total_deaths_label),\n                           family = \"text\",color = \"white\", \n                           fontface = \"bold\", lineheight = 0.3,size = 12) +\n  geom_circlepack_text(aes(label = age_group_clean),color = \"#f1fffe\",size = 9,\n                       check_overlap = TRUE,family = \"caption\", lineheight = 1) + #theme_void() +\n  facet_wrap(~year) +\n  scale_color_identity() +\n   labs(title = title_text,\n        subtitle = subtitle_text,\n        caption = \"#Rstudio #ggcirclepack #ggplot2 | Source: World Health Organisation (2024)\"\n        ) +\n   theme(legend.position = \"none\",\n         strip.text = element_markdown(family = \"text\",\n                                       size = rel(3)),\n    legend.title.position = \"none\",\n    legend.title = element_text(\n      color = text_col,\n      hjust = 0.5,\n      family = \"text\",\n      face = \"bold\",\n      size = rel(2),\n    ),\n    legend.text = element_text(\n      color = text_col,\n      family = \"text\",\n      size = rel(1),\n      face = \"bold\"\n    ),\n  plot.title            = element_markdown(\n      size                = 60,\n      family              = \"title\",\n      face                = \"bold\",\n      color               = title_col,\n      lineheight          = 0.3,\n      margin              = margin(t = 5, b = 5),\n      hjust               = 0.5\n    ),        \n    plot.subtitle         = element_markdown(\n      size                = 35, \n      family              = 'subtitle',\n      color               = subtitle_col,\n      hjust               = 0,\n      lineheight          = 0.4, \n      margin              = margin(t = 15, b = 1)\n    ),\n      plot.caption          = element_markdown(\n      size                = rel(2), \n      family              = 'caption',\n      color               = caption_col,\n      lineheight          = 0.3,\n      hjust               = 0.5,\n      halign              = 1,\n      margin              = margin(t = 10, b = 10)\n    ),\n  axis.text = element_blank(),\n  axis.title.y = element_blank(),\n  panel.grid.major = element_blank(),  # Remove major grid lines\n  panel.grid.minor = element_blank()   # Remove minor grid lines\n  ) + scale_fill_continuous_tableau(palette = \"Classic Red\") + coord_equal()\n  \n\ngr3\n```\n\n::: {.cell-output-display}\n![](matilda_viz_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggsave(\"images/Global_death_rate_age.jpeg\",gr3,dpi = 300,height = 6, width = 10)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_drug_dependency <- df_drug_dependency %>% clean_names()\n\ntitle_text <- \"Elevated Risk of Substance Dependence Among <br> Professionals in High-Stress Work Environments\"\nsubtitle_text <- \"A high-pressure work environment can significantly impact the mental well-being of professionals, often making them vulnerable to mental <br> health disorders. Statistics show a strong correlation between developing a mental health condition and subsequent substance dependence. <br> Among working professionals, the most common mental health disorders include <strong> ADHD, Social Phobia, Major Depression, and Generalized <br> Anxiety Disorder </strong>. The values presented indicate the likelihood of individuals who develop one of these conditions also turning to substance <br> use as a coping mechanism. <span style='color: darkred;'>A person with a diagnosed ADHD condition is 5.2 times likely to fall victim to substance use.</span> \"\n\nwork_conditions <- c(\"Generalized anxiety disorder (GAD)\",\"Major depression\",\n                     \"Social phobia\",\"Any Anxiety Disorder\",\"Attention deficit hyperactivity (ADHD)\")\n\ngr4 <- ggplot(data = df_drug_dependency,aes(x = increased_risk_of_illicit_drug_dependency,\n                                     y = reorder(entity,increased_risk_of_illicit_drug_dependency))) + \n  geom_col(fill = \"lightgray\") + \n  geom_col(data = df_drug_dependency %>% filter(entity %in% work_conditions) ,fill = \"#CD5C5C\") +\n  geom_text(aes(label = increased_risk_of_illicit_drug_dependency,\n                hjust = 1,fontface = \"bold\"),color = \"white\",size = 16) +\n  labs(x = \"Risk of substance dependency\",\n       y = \"\",\n       title = title_text,\n       subtitle = subtitle_text,\n       caption = \"#Rstudio #ggplot2 | Source: Swendsen et al. (2010)\") +\n  theme(legend.position = \"none\",\n    legend.title = element_text(\n      color = text_col,\n      hjust = 0.5,\n      family = \"text\",\n      face = \"bold\",\n      size = rel(2),\n    ),\n    legend.text = element_text(\n      color = text_col,\n      family = \"text\",\n      size = rel(1),\n      face = \"bold\"\n    ),\n    plot.title            = element_markdown(\n      size                = 70,\n      family              = \"title\",\n      face                = \"bold\",\n      color               = title_col,\n      lineheight          = 0.3,\n      margin              = margin(t = 5, b = 5),\n      hjust               = 0.5\n    ),        \n    plot.subtitle         = element_markdown(\n      size                = 35, \n      family              = 'subtitle',\n      color               = subtitle_col,\n      hjust               = 0,\n      lineheight          = 0.4, \n      margin              = margin(t = 5, b = 1)\n    ),\n      plot.caption          = element_markdown(\n      size                = rel(2), \n      family              = 'caption',\n      color               = caption_col,\n      lineheight          = 0.3,\n      hjust               = 0.5,\n      halign              = 0,\n      margin              = margin(t = 10, b = 10)\n    ),\n    axis.title = element_markdown(\n      size = 30,\n      family = \"caption\",\n      face = \"bold\"\n    ),\n    axis.text  = element_markdown(\n      size = 25,\n      face = \"bold\",\n      family = \"caption\"\n    ),\n   panel.grid.major = element_blank(),\n   panel.grid.minor = element_blank(),\n  ) \n\nggsave(\"images/drug_dependency.jpeg\",gr4,dpi = 300,height = 6, width = 10)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(treemapify)\n\n\ntitle_text <- \"Tobacco’s Toll: Addressing the Leading Cause of Global Substance-Related Deaths\"\n\nsubtitle_text <- \"In 2021, the global annual number of deaths caused by substance use highlighted <strong> tobacco as the leading cause </strong>, with a staggering <span style='color: darkred;'> 7.2 million <br> deaths </span>. <strong>Alcohol</strong> followed as the second highest at <span style='color: darkred;'>2 million deaths</span>, and <strong>illicit drugs</strong> accounted for <span style='color: darkred;'>0.6 million deaths</span>. The overwhelming <br> number of deaths from tobacco, primarily due to smoking,suggests that a significant portion of the global population remains dependent on it. <br> Smoking is often the first substance people become addicted to, often triggered by mental health challenges such as stress. The fact that <br> <span style='color: darkred;'><strong> tobacco- related deaths are more than three times higher than the next leading cause of substance-related deaths </span></strong> underscores the <br> urgent need for focused efforts to limit easy access to tobacco products, such as cigarettes, and to promote cessation programs and <br> awareness campaigns to combat tobacco addiction.\"\n\ngr7 <- ggplot(df_drug_deaths, aes(area = deaths, fill = deaths,\n               label = paste0(round(deaths/10^6,1),\" mil deaths\",\"\\n\",drug),\n               size = 2.5,\n               family = \"text\")) +\n  geom_treemap(color = \"black\",size = 3) +\n  geom_treemap_text(colour = \"#FEF9E7\",\n                    place = \"centre\",\n                    fontface = \"bold\", \n                    layout = \"squarified\",\n                    family = \"text\", \n                    grow = TRUE, \n                    padding.x = grid::unit(7, \"mm\"), \n                    padding.y = grid::unit(7, \"mm\")) +\n  scale_fill_continuous_tableau(palette = \"Red\") +\n  labs(title = title_text,\n       subtitle = subtitle_text,\n       caption = \"#Rstudio #ggtreemap #ggplot2 | Source: IHME Global Burden of Disease (2021)\") +\n  theme(legend.position = \"none\",\n    legend.title = element_text(\n      color = text_col,\n      hjust = 0.5,\n      family = \"text\",\n      face = \"bold\",\n      size = rel(1),\n    ),\n    legend.text = element_text(\n      color = text_col,\n      family = \"text\",\n      size = rel(1),\n      face = \"bold\"\n    ),\n    plot.title            = element_markdown(\n      size                = 55,\n      family              = \"title\",\n      face                = \"bold\",\n      color               = title_col,\n      lineheight          = 0.3,\n      margin              = margin(t = 5, b = 5),\n      hjust               = 0.5\n    ),        \n    plot.subtitle         = element_markdown(\n      size                = 35, \n      family              = 'subtitle',\n      color               = subtitle_col,\n      hjust               = 0,\n      lineheight          = 0.4, \n      margin              = margin(t = 5, b = 1)\n    ),\n      plot.caption          = element_markdown(\n      size                = rel(2), \n      family              = 'caption',\n      color               = caption_col,\n      lineheight          = 0.5,\n      hjust               = 0.5,\n      halign              = 0,\n      margin              = margin(t = 10, b = 10)\n    ),\n    axis.title = element_markdown(\n      size = rel(0.7),\n      family = \"caption\",\n      face = \"bold\"\n    ),\n    axis.text  = element_markdown(\n      size = rel(0.7),\n      face = \"bold\",\n      family = \"caption\"\n    )\n  ) \n\nggsave(\"images/tobacco_deaths.jpeg\",gr7,dpi = 300,height = 6, width = 10)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_drug_deaths$main <- \"Deaths due to substance abuse\"\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncigs_sales <- read_csv(here::here(\"data/sales-of-cigarettes-per-adult-per-day.csv\"), show_col_types = FALSE)\n\ncigs_sales_tidy <- cigs_sales %>%\n                   rename(cigs_sales_daily = `Sales of cigarettes per adult per day (International Smoking Statistics (2017))`) %>%\n                   select(Entity, Year, cigs_sales_daily)\n\nlung_cancer <- read_csv(here::here(\"data/lung-cancer-deaths-per-100000-by-sex-1950-2002.csv\"), show_col_types = FALSE)\n\nlung_cancer_tidy <- lung_cancer %>% select(!Code) %>%\n                                    pivot_longer(cols = -1:-2,\n                                                 names_to = \"gender\",\n                                                 values_to = \"death_rate\") %>%\n                                    mutate(gender = as.character(gender)) %>%\n                                    mutate(gender = str_replace_all(gender, \"age-standardized_death_rate_per_100k_\", \"\"))\n                                    \nlc_summarised <- lung_cancer_tidy %>%\n                 select(Year, death_rate) %>%\n                 group_by(Year) %>%\n                 summarise(avg_death_rate = round(mean(death_rate),2)) %>%\n                 arrange(Year)\n\n\nlc_cigs_summarised <- cigs_sales_tidy %>%\n                        select(Year, cigs_sales_daily) %>%\n                        group_by(Year) %>%\n                        summarise(cigs_sales_daily = mean(cigs_sales_daily)) %>%\n                        left_join(lc_summarised, by = \"Year\") %>%\n                        filter(Year %in% 1950:2015)\n\n\nscale = 2\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\n\ntitle_text <- \"Turning the Tide: Decreasing Cigarette Consumption and Deaths <br> Among Smokers\"\n  \nsubtitle_text <- \"Smoking tobacco-based products remains the most widely abused addictive substance, particularly among  individuals struggling with <br> mental health issues. The harmful effects of smoking are well-documented, with lung cancer  being a leading cause of death among heavy <br> smokers. However, there is <strong>a positive trend emerging: the average number of cigarettes sold per adult (aged 15 and above) has been <br> steadily declining since 1974.</strong> <br> <br> This decline is accompanied by a <strong>notable reduction in annual death rates among smokers.</strong> If this trend continues, both the average <br> number of cigarettes sold per adult and the related death rates are <strong>expected to reach record lows </strong> in the coming years. This marks a <br> significant step forward in the fight against substance abuse and its detrimental health effects.\"\n\nlc_cigs_summarised_long <- lc_cigs_summarised %>% pivot_longer(cols = c(2:3),names_to = \"metric\",values_to = \"value\")\ncig_sales <- diff(range(lc_cigs_summarised_long$value[lc_cigs_summarised_long$metric == \"cigs_sales_daily\"]))\navg_death <- diff(range(lc_cigs_summarised_long$value[lc_cigs_summarised_long$metric == \"avg_death_rate\"]))\n\ncig_sales_future_model <- lm(value ~ Year, data = lc_cigs_summarised_long %>% filter(metric == \"cigs_sales_daily\" & Year>=1980))\navg_death_future_model <- lm(value ~ Year, data = lc_cigs_summarised_long %>% filter(metric == \"avg_death_rate\" & Year>=1980))\n\n\nscale_factor <- cig_sales / avg_death\n\nfuture_years <- data.frame(Year = seq(2016, 2035))\n\ncigs_sales_future <- tibble(Year = seq(2016, 2035),\n                            metric = \"Cigarette sales per adult\",\n                            value = predict(cig_sales_future_model,\n                                            newdata = future_years))\navg_death_future <- tibble(Year = seq(2016, 2035),\n                           metric = \"Average death rate\",\n                            value = predict(avg_death_future_model,\n                                            newdata = future_years))\n\nlc_cigs_summarised_long <- rbind(lc_cigs_summarised_long,cigs_sales_future,avg_death_future)\n\ngr5 <- ggplot(lc_cigs_summarised_long, aes(x = Year)) +\n  # First metric\n  geom_line(aes(y = value,linetype = metric), \n            data = lc_cigs_summarised_long %>% filter(metric == \"cigs_sales_daily\"),linewidth = 1.2) +\n  \n  # Second metric on secondary axis\n  geom_line(aes(y = value * scale_factor,linetype = metric), \n            data = lc_cigs_summarised_long %>% filter(metric == \"avg_death_rate\"),linewidth = 1.2) +\n    geom_line(aes(y = value * scale_factor,color = metric), \n            data = lc_cigs_summarised_long %>% filter(metric == \"Average death rate\"),linewidth = 1.2) +\n    geom_line(aes(y = value,color = metric), \n            data = lc_cigs_summarised_long %>% filter(metric == \"Cigarette sales per adult\"),linewidth = 1.2) +\n    geom_segment(aes(x = 1973.5,\n                   y = 7.6,\n                   xend = 1968,\n                   yend = 8),\n               linewidth= 0.2) +\n  geom_point(\n    data = filter(lc_cigs_summarised_long),\n    aes(x = 1974,y = 7.7),\n    size = 4,\n    color = \"darkred\"\n  ) +\n  \n  annotate(geom = \"text\",\n           x = 1957,\n           y = 7.8,\n           size = 12,\n           label = 'First reported decrease in \\n global cigarette sales in 1974',\n           fontface = \"bold\",\n          family = \"text\",\n          lineheight = 0.2) +\n  \n      geom_segment(aes(x = 1988,\n                   y = 6.1,\n                   xend = 1980,\n                   yend = 4),\n               linewidth= 0.2) +\n  geom_point(\n    data = filter(lc_cigs_summarised_long),\n    aes(x = 1988,y = 6.1),\n    size = 4,\n    color = \"darkred\"\n  ) +\n  annotate(geom = \"text\",\n           x = 1980,\n           y = 3.3,\n           size = 12,\n           lineheight = 0.2,\n           label = 'Decreasing trend in \\n annual smoking death rates after 1990',\n           fontface = \"bold\",\n          family = \"text\") +\n  \n  scale_color_manual(values = c(`Average death rate` = \"darkred\",`Cigarette sales per adult` = \"orange\")) +\n  scale_y_continuous(\n    name = \"Average daily cigarette sales <br> per adult\", \n    sec.axis = sec_axis(~ . / scale_factor, name = \"Average death rate <br> per 100K people\")) + \n  guides(linetype = FALSE) +\n  labs(x = \"Year\",\n       color = \"Projections\",\n       title = title_text,\n       subtitle = subtitle_text,\n       caption = \"#Rstudio #ggplot2 | Source: International Smoking Statistics (2016)\") +\n  theme(legend.position = \"bottom\",\n    legend.title = element_markdown(\n      color = text_col,\n      hjust = 0.5,\n      family = \"text\",\n      face = \"bold\",\n      size = rel(3),\n    ),\n    legend.text = element_text(\n      color = text_col,\n      family = \"text\",\n      size = rel(2),\n      face = \"bold\"\n    ),\n    plot.title            = element_markdown(\n      size                = 70,\n      family              = \"title\",\n      face                = \"bold\",\n      color               = title_col,\n      lineheight          = 0.3,\n      margin              = margin(t = 5, b = 5),\n      hjust               = 0.5\n    ),        \n    plot.subtitle         = element_markdown(\n      size                = 35, \n      family              = 'subtitle',\n      color               = subtitle_col,\n      hjust               = 0,\n      lineheight          = 0.4, \n      margin              = margin(t = 5, b = 1)\n    ),\n      plot.caption          = element_markdown(\n      size                = rel(2), \n      family              = 'caption',\n      color               = caption_col,\n      lineheight          = 0.3,\n      hjust               = 0.5,\n      halign              = 0,\n      margin              = margin(t = 10, b = 10)\n    ),\n    axis.title = element_markdown(\n      size = rel(2.2),\n      family = \"caption\",\n      face = \"bold\",\n      lineheight = 0.2\n    ),\n    axis.text  = element_markdown(\n      size = rel(2),\n      face = \"bold\",\n      family = \"caption\"\n    )\n  ) \n\nggsave(\"images/cig_sales.jpeg\",gr5,dpi = 300,height = 6, width = 10)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_overdose_long <- df_overdose %>% pivot_longer(cols = c(4:8),names_to = \"drug_type\",values_to = \"death_rate\")\n\n\ndf_overdose_long <- df_overdose_long %>% mutate(drug_type_clean = case_match(drug_type,\"Any opioid death rates (CDC WONDER)\" ~ \"Other Opioids\",\n                                                                            \"Cocaine overdose death rates (CDC WONDER)\" ~ \"Cocaine\",\n                                                                            \"Heroin overdose death rates (CDC WONDER)\" ~ \"Heroin\",\n                                                                            \"Prescription Opioids death rates (US CDC WONDER)\" ~ \"Prescription Opioids\",\n                                                                            \"Synthetic opioids death rates (CDC WONDER)\" ~ \"Synthetic Opioids\"))\n\n\ndf_overdose_long$drug_type_clean <- factor(df_overdose_long$drug_type_clean,levels = c(\"Heroin\",\"Prescription Opioids\",\n                                                                                       \"Cocaine\",\"Other Opioids\",\"Synthetic Opioids\")) \ndf_overdose_percent <- df_overdose_long %>% group_by(drug_type_clean) %>% \n  mutate(per = round((death_rate - first(death_rate))/first(death_rate),0)) %>% arrange(-per) %>% filter(Year == 2020) \n\ncols <- c(\"Other Opioids\" = \"darkred\", \n          \"Cocaine\" = \"#E59866\",\n          \"Prescription Opioids\" = \"#F4D03F\",\n          \"Synthetic Opioids\" = \"darkred\",\n          \"Heroin\" = \"#16A085\")\n\ntitle_text <- \"Rising Overdose Deaths: An Urgent Call for Action <br> on Illicit Drug Abuse\"\nsubtitle_text <- \"The recent surge in overdose deaths in the United States, particularly due to illicit drugs like opioids, heroin, and cocaine, is deeply <br> concerning. This trend suggests that more people are increasingly turning to these substances, potentially driven by underlying issues <br> such as mental health disorders, which lead to addiction and, ultimately, fatal outcomes. In recent years, the <strong> annual death rate due to <br> overdoses has climbed to 20 per 100,000 people </strong> and continues to rise at an alarming pace, particularly for <span style='color: darkred;'>synthetic opioids <br> whose death rates have risen by 58 times since the year 1999</span>. <br> <br> The upward trajectory highlights an <span style='color: darkred;'>urgent need for targeted interventions to address the growing number of drug users </span> and prevent <br> further loss of life due to substance abuse.\"\n\ngr6 <- ggplot(data = df_overdose_long,aes(x = Year,y = death_rate)) + geom_line(aes(color = drug_type_clean),linewidth = 0.8,\n                                                                                arrow = arrow(type = \"closed\", \n                                                                                              length = unit(0.1, \"inches\"))) +\n  geom_area(alpha = 0.4,aes(fill = drug_type_clean)) + \n  geom_richtext(\n         data = df_overdose_percent, aes(x = 2012, y = 15, label = glue::glue(\"<strong> {per} times rise </strong>\")),\n         hjust = 1,\n         vjust = -0.15,\n         fill = NA,\n         size =14,\n         color = \"darkred\",\n         label.padding = unit(.125, \"lines\"),\n         label.r = unit(0, \"lines\"),\n         label.size = unit(0, \"lines\")\n     ) +\n  facet_wrap(~drug_type_clean,nrow = 1)  +\n  scale_fill_manual(values = cols) +\n  scale_color_manual(values = cols) +\n    coord_cartesian(clip = 'off') +\n  labs(x = \"Year\",y = \"Annual death rate <br> per 100K people\",\n       title = title_text,\n       subtitle = subtitle_text,\n       caption = \"#Rstudio #ggplot2 | Source: US Centers for Disease Control and Prevention\") +\n  theme(legend.position = \"none\",\n        strip.text = element_markdown(\n          family = \"text\",\n          face = \"bold\",\n          size = rel(3)\n        ),\n    legend.title = element_markdown(\n      color = text_col,\n      hjust = 0.5,\n      family = \"text\",\n      face = \"bold\",\n      size = rel(1),\n    ),\n    legend.text = element_text(\n      color = text_col,\n      family = \"text\",\n      size = rel(1),\n      face = \"bold\"\n    ),\n    plot.title            = element_markdown(\n      size                = 70,\n      family              = \"title\",\n      face                = \"bold\",\n      color               = title_col,\n      lineheight          = 0.3,\n      margin              = margin(t = 5, b = 5),\n      hjust               = 0.5\n    ),        \n    plot.subtitle         = element_markdown(\n      size                = 35, \n      family              = 'subtitle',\n      color               = subtitle_col,\n      hjust               = 0,\n      lineheight          = 0.4, \n      margin              = margin(t = 5, b = 1)\n    ),\n      plot.caption          = element_markdown(\n      size                = rel(2), \n      family              = 'caption',\n      color               = caption_col,\n      lineheight          = 0.3,\n      hjust               = 0.5,\n      halign              = 0,\n      margin              = margin(t = 10, b = 10)\n    ),\n    axis.title.x = element_markdown(\n      size = rel(2),\n      family = \"text\",\n      face = \"bold\"\n    ),\n      axis.title.y = element_markdown(\n      size = rel(2),\n      family = \"text\",\n      lineheight = 0.2,\n      face = \"bold\"\n    ),\n    axis.text.x  = element_markdown(\n      size = rel(2.2),\n      face = \"bold\",\n      family = \"caption\"\n    ),\n    axis.text.y  = element_markdown(\n      size = rel(2.5),\n      face = \"bold\",\n      family = \"caption\"\n    )\n  ) \n\nggsave(\"images/overdose_deaths.jpeg\",gr6,dpi = 300,height = 6, width = 10)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# work_interfere\n# care_options\n# mentalvsphysical\n\ndf_survey_interfere <- df_survey %>% group_by(work_interfere) %>% drop_na() %>% summarise(Total = n()) %>%\n                       mutate(metric = \"Work Interference\") %>% rename(\"score\" = \"work_interfere\")\n\ndf_survey_care <- df_survey %>% group_by(care_options) %>% summarise(Total = n()) %>%\n   mutate(metric = \"Care benefits\") %>% rename(\"score\" = \"care_options\")\n\ndf_survey_mentvphy <- df_survey %>% group_by(mental_vs_physical)  %>% summarise(Total = n()) %>%\n  mutate(metric = \"Importance\") %>% \n  rename(\"score\" = \"mental_vs_physical\")\n\ndf_survey_leave <- df_survey %>% group_by(leave) %>% summarise(Total = n()) %>% mutate(metric = \"Leave benefits\") %>%\n  rename(\"score\" = \"leave\")\n\ndf_survey_stats <- rbind(df_survey_interfere,df_survey_care,df_survey_mentvphy,df_survey_leave)\n\ndf_survey_stats <- df_survey_stats %>% mutate(sentiment = case_match(score,\n                                                                     \"Don't know\" ~ \"Neutral\",\n                                                                     \"Somewhat difficult\" ~ \"Negative\",\n                                                                     \"Very difficult\" ~ \"Negative\",\n                                                                     \"No\" ~ \"Negative\",\n                                                                     \"Not sure\" ~ \"Neutral\",\n                                                                     \"Sometimes\" ~ \"Neutral\",\n                                                                     \"Never\" ~ \"Positive\",\n                                                                     \"Rarely\" ~ \"Positive\",\n                                                                     \"Often\" ~ \"Negative\",\n                                                                     .default = \"Positive\",\n                                                                     ))\n\ndim_order <- c(\"Positive\",\"Neutral\",\"Negative\")\ndf_survey_stats$sentiment <- factor(df_survey_stats$sentiment,levels = dim_order)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncustom_colors <- c(\"Negative\" = \"#CB4335\",  \n                   \"Neutral\" = \"#D4AC0D\",  \n                   \"Positive\" = \"#1E8449\") \n\ntitle_text <- \"Mental Health in High-Stress Work Environments: <br> Are Employers Doing Enough?\"\nsubtitle_text <- \"A <strong>2016 global survey of tech industry employees across 48 countries</strong> explored this issue, finding that about <strong> 75% of respondents believed, <br> or were unsure, that mental health problems interfered with their job performance.</strong> Despite this, over 50% felt that their employers did not <br> take sufficient steps to address mental health concerns. </span> <br> <br> This trend highlights a significant issue: <span style='color: darkred;'><strong>employees in high-stress industries like tech may develop severe mental health problems and <br> turn to illicit substances as coping mechanisms.</span></strong> This underscores the urgent need for better mental health support in workplaces to prevent <br> these outcomes.\"\ngr8 <- ggplot(data = df_survey_stats,aes(x = Total,y = metric,fill = sentiment)) + \n  geom_col(position = \"fill\") + theme(legend.position = \"top\") +\n  scale_x_continuous(expand = c(0, 0), labels = scales::percent) +\n  scale_fill_manual(values = custom_colors,limits = c(\"Negative\",\"Neutral\",\"Positive\")) +\n  labs(x = \"Percentage of respondents\",\n       y = \"Survey metric\",\n       fill = \"Survey response on \\n mental health at workplace\",\n       title = title_text,\n       subtitle = subtitle_text,\n       caption = \"#Rstudio #ggplot2 | Source: OSMI Tech Survey (2016)\"\n       ) +\n  theme(legend.position = \"top\",\n        strip.text = element_markdown(\n          family = \"text\",\n          face = \"bold\",\n          size = rel(0.7)\n        ),\n    legend.title = element_text(\n      color = text_col,\n      hjust = 0.5,\n      family = \"text\",\n      face = \"bold\",\n      lineheight = 0.2,\n      size = rel(2.5),\n    ),\n    legend.text = element_text(\n      color = text_col,\n      family = \"text\",\n      size = rel(2),\n      face = \"bold\"\n    ),\n    plot.title            = element_markdown(\n      size                = 70,\n      family              = \"title\",\n      face                = \"bold\",\n      color               = title_col,\n      lineheight          = 0.3,\n      margin              = margin(t = 5, b = 5),\n      hjust               = 0.5\n    ),        \n    plot.subtitle         = element_markdown(\n      size                = 35, \n      family              = 'subtitle',\n      color               = subtitle_col,\n      hjust               = 0,\n      lineheight          = 0.4, \n      margin              = margin(t = 5, b = 1)\n    ),\n      plot.caption          = element_markdown(\n      size                = rel(2), \n      family              = 'caption',\n      color               = caption_col,\n      lineheight          = 0.3,\n      hjust               = 0.5,\n      halign              = 0,\n      margin              = margin(t = 10, b = 10)\n    ),\n    axis.title = element_markdown(\n      size = rel(3),\n      lineheight = 0.2,\n      family = \"caption\",\n      face = \"bold\"\n    ),\n    axis.text  = element_markdown(\n      size = rel(2.4),\n      face = \"bold\",\n      family = \"caption\"\n    )\n  ) \n  \nggsave(\"images/mental_health_survey.jpeg\",gr8,dpi = 300,height = 6, width = 10)\n```\n:::\n\n\n\n200-word paragraph\n\nThe infographic titled “The Dual Crisis: Mental Health and Substance Abuse in the Modern World” highlights the alarming global trends in drug use, mental health, and substance-related deaths. It emphasises that men are disproportionately affected by drug-related mortality. Deaths from mental health and substance use disorders have significantly increased, especially in the U.S. and Canada, with a sharp spike following the COVID-19 pandemic. Among middle-aged individuals, those aged 15 to 49—especially working professionals in high-stress environments—are most affected by substance use disorders, suggesting work-related stress as a major contributing factor.\n\nTobacco remains the most lethal substance, causing over 7.2 million deaths annually—three times more than alcohol and significantly higher than illicit drugs. However, there’s a positive trend in declining cigarette consumption, with usage falling since 1974 and projections suggesting continued decline. On the other hand, the data also presents a concerning rise in synthetic drug use, with opioid overdose deaths surging by 58 times since 1990. The data underscores the urgent need for mental health support, particularly in high-stress industries, where professionals are at an elevated risk of substance dependence. Employers’ lack of adequate mental health support is also highlighted as a critical issue.\n",
    "supporting": [
      "matilda_viz_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}