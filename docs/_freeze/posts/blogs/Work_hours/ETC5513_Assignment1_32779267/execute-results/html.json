{
  "hash": "3a0869fb2e0a1ebaad736370db76c1a7",
  "result": {
    "markdown": "---\ntitle: \"ETC 5513 Assignment 1\"\nauthor: \"Arindam Baruah (32779267)\"\ndate: \"2023-03-19\"\nheader-includes: \n- \\setcounter{secnumdepth}{0}\n\noutput:\n  bookdown::html_document2:\n   \n    css: CSSBackground.css\n    toc: true\n    toc_float: true\n    theme: united\n    \n---\n\n::: {.cell}\n<style type=\"text/css\">\n.watch-out {\n  background-color: lightgray;\n  border: 3px solid black;\n  font-weight: bold;\n  \n}\n</style>\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n\n# Introduction\n\nThe current dataset contains the __annual working hours per worker along with the population estimates of all the reporting countries__ dating from the start of the calendar year to 2021. The data source has been detailed on the __Our World In Data__ [website](https://ourworldindata.org).\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Source: www.ondeck.com](images/image_1.png){fig-align='center' width=800px height=300px}\n:::\n:::\n\n\n\nThis is an important metric to track as the number of annual working hours is a strong indicator of the labor laws prevalent in the country along with the work-life balance for the various employees. High working hours invariably lead to higher health issues such as stress, anxiety, and depression. With the advent of strict labor laws for the welfare of employees, the current study will dive deeper into how long are employees from various countries and continents working as years have passed on and whether the long hours are indicating strong growth in the economy.\n\n# What are we looking to answer?\n\nThe current study aims to answer some of the following pertinent questions:\n\n1. Which countries are reporting the highest annual working hours per employee? How have the annual working hours changed for these countries over time after stricter measures such as the implementation of labor codes in recent decades?\n2. How are the working hours different for countries with high productive economies (GDP) ? Do the annual working hours vary with population and how do countries with comparable populations such as China and India fare?\n3. Does working for longer hours directly mean that the productivity output of the economy is higher ? \n\n# What is this dataset all about?\n\nThe current dataset which has been sourced from the __Our World In Data__ website records the average annual working hours, state of economy (in terms of GDP), and population for a particular country over the years. In addition to these variables, the current dataset is merged with another dataset which contains important data on the ${productivity}/{hour}$ for the reporting countries. This measure in effect, tells us about the economic productivity of the country for every hour of work done by an employee __(in $/hour)__.\n\nThe above-mentioned dataset can be obtained from the \"Our World in Data\" website through this [link](https://ourworldindata.org/rich-poor-working-hours).\n\n Table \\@ref(tab:variable) below shows the various variables present in our dataset.\n\n\n::: {.cell layout-align=\"center\" hash='ETC5513_Assignment1_32779267_cache/html/variable_0c94c15456d4935b8398e86d0e3fabcd'}\n\n```{.r .watch-out .cell-code}\nvar <- data.frame(Variable_names = names(df_final)) #A dataframe for variables\n\nvar %>% kable(caption = 'This table contains the various variables present in this dataset which will allow us to analyse the annual working hours of the countries under consideration. Additionally, the variables in this table will allow us to understand the productivity towards the economy for each nation',booktabs = TRUE) %>% \nkable_styling(bootstrap_options = c(\"bordered\",\"hover\")) %>% \nrow_spec(0,background=\"rgb(172,175,145)\",color='black',font_size = 18)#Creating a table\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-bordered table-hover\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>This table contains the various variables present in this dataset which will allow us to analyse the annual working hours of the countries under consideration. Additionally, the variables in this table will allow us to understand the productivity towards the economy for each nation</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;color: black !important;background-color: rgb(172,175,145) !important;font-size: 18px;\"> Variable_names </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Entity </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Code </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Year </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Annual working hours per worker </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> GDP per capita (output, multiple price benchmarks) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Population (historical estimates) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Continent </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Productivity: output per hour worked </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n \n## What does our data contain ?\n\n 1. Here are some of the important descriptions of the dataset:\n\n- The current dataset contains a total of __8__ variables.\n- A total of __55873__ observations were recorded in the dataset.\n\n 2. The image \\@ref(fig:inline) shows the inline r codes that were used to obtain the above results.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .watch-out .cell-code}\n knitr::include_graphics(\"images/inline_r.png\")\n```\n\n::: {.cell-output-display}\n![Inline R codes](images/inline_r.png){fig-align='center' width=1000px height=50px}\n:::\n:::\n\n\n 3. After applying the head function to display the first two rows of the clean data, we find the following results.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .watch-out .cell-code}\ndf_clean <- na.omit(df_final)\nhead(df_clean,2) %>% \n  DT::datatable(width = 1000, height = 450, options = list(pageLength = 2)) #Transforms a dataframe to an intuitive datatable.\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-cb8e14c471f2fd00e2bb\" style=\"width:1000px;height:450px;\" class=\"datatables html-widget \"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-cb8e14c471f2fd00e2bb\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"2290\",\"3219\"],[\"Argentina\",\"Australia\"],[\"ARG\",\"AUS\"],[2015,2015],[1703.4685,1746.4835],[21197.787,48712.19],[43257064,23820240],[\"South America\",\"Oceania\"],[26.997778,56.053726]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>Entity<\\/th>\\n      <th>Code<\\/th>\\n      <th>Year<\\/th>\\n      <th>Annual working hours per worker<\\/th>\\n      <th>GDP per capita (output, multiple price benchmarks)<\\/th>\\n      <th>Population (historical estimates)<\\/th>\\n      <th>Continent<\\/th>\\n      <th>Productivity: output per hour worked<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":2,\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4,5,6,8]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false,\"lengthMenu\":[2,10,25,50,100]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n\n\n 4. The datatypes of the variables in the dataset can be observed through the results of the following R code chunk.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .watch-out .cell-code}\nstr(df_clean) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n'data.frame':\t65 obs. of  8 variables:\n $ Entity                                            : chr  \"Argentina\" \"Australia\" \"Austria\" \"Bangladesh\" ...\n $ Code                                              : chr  \"ARG\" \"AUS\" \"AUT\" \"BGD\" ...\n $ Year                                              : num  2015 2015 2015 2015 2015 ...\n $ Annual working hours per worker                   : num  1703 1746 1605 2419 1575 ...\n $ GDP per capita (output, multiple price benchmarks): num  21198 48712 49619 3715 42891 ...\n $ Population (historical estimates)                 : num  4.33e+07 2.38e+07 8.64e+06 1.58e+08 1.12e+07 ...\n $ Continent                                         : chr  \"South America\" \"Oceania\" \"Europe\" \"Asia\" ...\n $ Productivity: output per hour worked              : num  27 56.05 62.7 4.03 66.49 ...\n - attr(*, \"na.action\")= 'omit' Named int [1:55808] 1 2 3 4 5 6 7 8 9 10 ...\n  ..- attr(*, \"names\")= chr [1:55808] \"1\" \"2\" \"3\" \"4\" ...\n```\n:::\n:::\n\n\n# What can we infer from the data ?\n\nIn order to answer some of the pertinent research questions, we will need to create visualizations that can help us understand the data better and allow us to draw inferences. The intuitive visualizations are created using the __ggplot2__ library which is based on the grammar of graphics. The documentation for the ggplot2 library can be  referred to in greater detail through this [link](https://ggplot2.tidyverse.org).\n\nFigure \\@ref(fig:plot1) is a scatter plot between the annual working hours and the GDP per capita of some of the nations of concern in the current study.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .watch-out .cell-code}\ncountries <- c('India','China','Switzerland','Australia','United States','Germany','France','United Kindgom','Luxembourg','Canada','Singapore') #Countries under consideration\n\ndf_2019 <- df_final %>% select(c(`Year`,`Entity`,`Annual working hours per worker`,\n                                 `GDP per capita (output, multiple price benchmarks)`,\n                                 `Population (historical estimates)`)) %>% \n  filter(Year==2019, `Annual working hours per worker`!='NA',\n         `GDP per capita (output, multiple price benchmarks)`!='NA',Entity %in% countries) %>% \n  arrange(-`GDP per capita (output, multiple price benchmarks)`) #Filtering the data \n\noptions(scipen=1) #Removes scientific notation in the plot\n\npl1<- ggplot(head(df_2019,10),aes(x=`GDP per capita (output, multiple price benchmarks)`,\n                                  y=`Annual working hours per worker`,\n                                  color=`Entity`,\n                                  label=Entity)) + \n  labs(color= \"Country\") + \n  geom_point(alpha=0.9,size=2) + \n  geom_text(hjust=0.7,vjust=-0.7,size=4) + \n  theme_economist() + \n  theme(legend.position=\"none\",plot.title = element_text(size = 20, face = \"bold\",hjust=0.5)) + \n  ylim(1200,2500) + xlim(0,100000) + xlab('GDP Per capita (in $)') + \n  ggtitle(\"Annual working hour vs GDP per capita\") +\n  annotate(\"segment\", x = 45000, xend = 45000, y = 1200, yend = 2500,\n           colour = \"red\",\n           alpha=0.6,\n           linetype=3) +\n  annotate(\"segment\", x = 0, xend = 90000, y = 1800, yend = 1800,\n           colour = \"red\",\n           alpha=0.6,\n           linetype=3) +\n  annotate(\"text\", x = 15000, y= 1500, \n           colour = \"black\",\n           alpha=0.6,\n           label='Low hours and GDP per capita',\n           size = unit(3, \"pt\")) +\n  annotate(\"text\", x = 15000, y= 2000, \n           colour = \"black\",\n           alpha=0.6,\n           label='High hours and low GDP per capita',\n           size = unit(3, \"pt\")) +\n  annotate(\"text\", x = 65000, y= 2000, \n           colour = \"black\",\n           alpha=0.6,\n           label='High hours and GDP per capita',\n           size = unit(3, \"pt\")) +\n  annotate(\"text\", x = 65000, y= 1500, \n           colour = \"black\",\n           alpha=0.6,\n           label='Low hours and high GDP per capita',\n           size = unit(3, \"pt\")) +\n  theme(panel.background = element_rect(fill = 'lightyellow'),\n        panel.border = element_rect(colour = \"black\",size=3),\n        axis.title=element_text(size=14,face=\"bold\")) #Plotting the graph\nprint(pl1)\n```\n\n::: {.cell-output-display}\n![Relation between annual working hours and GDP per capita](images/plot1-1.png){fig-align='center' width=672}\n:::\n:::\n\nFigure \\@ref(fig:plot1) titled __\"Annual working hour vs GDP per capita\"__ represents a scatter plot with the X-axis containing the variable of __GDP Per capita (in $)__ and the Y-axis containing the variable of __Annual working hours per worker__. The plot has been created for a list of countries with well-established economies along with some of the manufacturing-based economies like China and India. Below are some of the key points observed that can provide answers to the research questions posed in section 3 :\n\n- _The scatterplot has been divided into 4 quadrants to facilitate the clustering of the various economies and the quadrants have been explained through the plot annotation. We can observe that the emerging developing nations with comparable populations such as **India and China** are reporting considerably higher annual working hours than the other major developed economies. This could be a result of the **lack of strict labor codes** prevalent in these countries leading to highly overworked employees._\n\n- _**Singapore** is a developed economy with a very low population. Yet, the annual working hours are reported to be higher than all the developed nations as well as the developing economies of India and China. This could be attributed to the hectic working culture prevalent in the corporates of the country._   \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .watch-out .cell-code}\ndf_productivity <- df_final %>% select(c(`Entity`,`Year`,\n                                 `Productivity: output per hour worked`)) %>% \n                                  filter(`Productivity: output per hour worked`!='NA',\n                                         Entity %in% countries) %>%\n                                  arrange(-`Productivity: output per hour worked`)\n\npl2<- ggplot(df_productivity,aes(x=Year,y=`Productivity: output per hour worked`,color=Entity)) + \n                                  geom_line(size=2) + geom_point(size=3) + theme_economist() + labs(color='Country') + \n \n  ggtitle(\"Productivity over the years\") + \n  ylab(\"Productivity : in GDP $/Hour\") + \n  scale_color_brewer(palette = \"Set3\") + \n  theme(panel.background = element_rect(fill = '#CCFFFF'),\n        plot.title = element_text(size = 25,\n        face = \"bold\",hjust=0.5),\n        legend.key.size = unit(0.25, 'cm'),\n        panel.border = element_rect(colour = \"black\",size=3),\n        axis.title=element_text(size=14,face=\"bold\")) +\n  annotate(\"text\", x = 1970, y= 60, \n           colour = \"black\",\n           alpha=0.6,\n           label='Overall rising trend of productivity',\n           size = unit(4, \"pt\")) +\n  annotate(\"text\", x = 2000, y= 15, \n           colour = \"black\",\n           alpha=0.6,label='Comparatively low rising trend in productivity for China and India',\n           size = unit(3, \"pt\"))\nprint(pl2)\n```\n\n::: {.cell-output-display}\n![Productivity: Gross Domestic Produce per hour of work (in $/hr)](images/plot2-1.png){fig-align='center' width=672}\n:::\n:::\n\nFigure \\@ref(fig:plot2) titled __\"Productivity over the years\"__ represents a line chart containing a temporal analysis of the productivity of each of the selected nations from plot 1. Productivity is defined as the contribution to the GDP (in $) for each hour worked by an employee. The following can be inferred from the plot :\n\n- _The temporal analysis for productivity (contribution to GDP in $) against the years indicates that there is a **steady increase in the contribution** towards GDP (in $) for all the countries under consideration. In essence, the temporal trend suggests that over the many decades of study, an hour of work done by an employee yields a higher contribution towards the nation's economy for every country._\n\n- _In figure \\@ref(fig:plot1), it was established that **Singapore, China, and India** were the countries with the highest annual working hours. While intuitively, it may be hypothesized that higher working hours would mean greater productivity, however as per figure \\@ref(fig:plot2) , it can be observed that **the productivity of the economy for these three countries were found to be lower than that of the other economies**. Therefore, longer working hours per employee does not necessarily contribute to higher productivity of the economy._\n\n# Conclusion\n\nThe above study explored the various relations between the annual working hours of each country's economy, its GDP per capita  and the contribution towards the productivity of its economy. In order to create a condensed analysis of the major economies, a specific list of countries was curated and its results were visualised through figures \\@ref(fig:plot1) and \\@ref(fig:plot2) for inference. The study was observed to draw the following inferences delineated as follows :\n\n1. Emerging economies based on GDP per capita with similar populations such as China and India which are heavily dependent on their manufacturing industries were observed to have considerably higher annual working hours when compared to developed economies.This could be a result of the leaner labor codes enforced in these countries when compared to the developed economies.  \n\n2. While Singapore is a country with high GDP per capita and low population, it was observed to report higher annual working hours compared to China and India along with all other developed economies under consideration. This could be a result of the work culture in corporations based out of Singapore.\n\n3. A steady rise in the productivity of each nation under consideration was observed which essentially meant that an employee's hourly output has been increasing over time. \n\n4. While Singapore, China, and India reported the highest annual working hours, it's productivity was observed to be lower than all other developed economies in the current study. This finding demonstrated that higher annual working hours do not necessarily lead to higher productivity in the economy.\n\n\n______________________________________ __End of file__ _______________________________________",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n<script src=\"../../../site_libs/htmlwidgets-1.6.2/htmlwidgets.js\"></script>\n<link href=\"../../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../../../site_libs/datatables-binding-0.28/datatables.js\"></script>\n<script src=\"../../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../../../site_libs/dt-core-1.13.4/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"../../../site_libs/dt-core-1.13.4/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"../../../site_libs/dt-core-1.13.4/js/jquery.dataTables.min.js\"></script>\n<link href=\"../../../site_libs/crosstalk-1.2.0/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../../site_libs/crosstalk-1.2.0/js/crosstalk.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}